# EPCalendar

A calendar displayed on electronic paper.

Currently, it supports display in English or in Japanese and shows Japanese national holidays.

## Overview

1. Start the server
2. When the server is accessed, it returns an image of the rendered calendar
3. On the client side (electronic paper), once the date changes, the client fetches the image from the server
4. The client displays the fetched image on the electronic paper

## Required Equipment

- Electronic Paper: Waveshare 7.3inch e-Paper HAT (F)
- Raspberry Pi 4 or 5

It may also work with other combinations, but likely requires modifications to the source code.

## Development

### Server Side

Developed with Deno 2.1.4.
The calendar is generated by React on Next.js, and then Puppeteer is used to take a screenshot and produce the image.  
Dithering is applied to convert it into colors that can be displayed on electronic paper, and the image is returned as a PNG.

After cloning this repository:

```bash
cd server
deno install
```

Then run:

```bash
deno task dev
```

to start the server at `http://localhost:3000`.

- Calendar image display:
  - <http://localhost:3000/api/image.png>
- Calendar HTML display:
  - <http://localhost:3000/calendar>

### Available query parameters

- `date`: Specifies the date for display. Available format: `YYYY-MM-DD`. (default: the date of today)
- `lang`: Specifies the language for display. Available options: `en` or `ja`. (default: `en`)
- `start`: Specifies whether the calendar week starts on Sunday or Monday. Available options: `monday` or `sunday` (default: `monday`)
- `dither`: (image only) Enables dithering when set to `1`. (default: disabled)

#### Examples

- <http://localhost:3000/calendar?date=2025-01-01&lang=ja&start=sunday>: Displays the calendar HTML in Japanese with the week starting on Sunday.
- <http://localhost:3000/api/image.png?date=2020-02-02&lang=en&start=monday&dither=1>: Displays the calendar image in English with the week starting on Monday and dithering enabled.
- <http://localhost:3000/api/image.png?lang=ja&start=monday>: Displays the calendar image in Japanese with the week starting on Monday.

## production build

```bash
deno task build
```

## Client Side

Not yet.
